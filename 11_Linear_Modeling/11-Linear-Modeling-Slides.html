<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.39">

  <meta name="author" content="A. Stamm">
  <title>Data Science with R – Linear Regression with R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-423d414d36ce366a9d05f36d06304417.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <style>
  .v-center-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 90%;
  }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Linear Regression with R</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
A. Stamm <a href="https://orcid.org/0000-0002-8725-3654" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
        <p class="quarto-title-affiliation">
            Department of Mathematics Jean Leray, UMR CNRS 6629, Nantes University, Ecole Centrale de Nantes
          </p>
    </div>
</div>

</section>
<section>
<section id="theory" class="title-slide slide level1 center">
<h1>Theory</h1>

</section>
<section id="the-linear-regression-model" class="slide level2">
<h2>The linear regression model</h2>
<div class="r-fit-text">
<p>The goal is to propose and estimate a model for explaining a <em>continuous response variable</em> <span class="math inline">\(Y_i\)</span> from a number of fixed <em>predictors</em> <span class="math inline">\(x_{i1}, \dots, x_{ik}\)</span>.</p>
<p>Mathematically, the model reads: <span class="math display">\[ Y_i = \beta_0 + \beta_1 x_{i1} + \dots + \beta_k x_{ik} + \varepsilon_i, \quad \mbox{with} \quad \mathbb{E}[\varepsilon_i] = 0 \quad \mbox{and} \quad \mathbb{V}\mbox{ar}[\varepsilon_i] = \sigma^2. \]</span></p>
<p>We can summarize the assumptions on which relies the linear regression model as follows:</p>
<ul>
<li>The predictors are fixed. This means that we do not assume (or take into account the) intrinsic variability in the predictor values. The randomness of <span class="math inline">\(Y_i\)</span> all comes from the error term <span class="math inline">\(\varepsilon_i\)</span>. In particular, it implies that considering a sample of <span class="math inline">\(n\)</span> <em>i.i.d.</em> random response variables <span class="math inline">\(Y_1, \dots, Y_n\)</span> boils down to assuming that <span class="math inline">\(\varepsilon_1, \dots, \varepsilon_n\)</span> are <em>i.i.d.</em>;</li>
<li>The error random variables <span class="math inline">\(\varepsilon_i\)</span> are centered and of constant variance. Combined with Assumption 1, this means that <span class="math inline">\(\mathbb{E}[\boldsymbol{\varepsilon}] = \mathbf{0}\)</span> and <span class="math inline">\(\mathrm{Cov}[\boldsymbol{\varepsilon}] = \sigma^2 \mathbb{I}_n\)</span>;</li>
<li>[<em>optional</em>] Parametric hypothesis testing and confidence intervals further require the assumption of normality for the error vector, <em>i.e.</em> <span class="math inline">\(\boldsymbol{\varepsilon} \sim \mathcal{N}(\mathbf{0}, \sigma^2 \mathbb{I}_n)\)</span>.</li>
</ul>
</div>
</section>
<section id="model-estimation-problem" class="slide level2">
<h2>Model Estimation Problem</h2>
<div class="r-fit-text">
<h3 id="matrix-representation">Matrix representation</h3>
<ul>
<li><span class="math inline">\(Y_1, \dots, Y_n\)</span> sample of <span class="math inline">\(n\)</span> <em>i.i.d.</em> random response variables with associated observed values <span class="math inline">\(y_1, \dots, y_n\)</span>,</li>
<li><strong>Design matrix</strong> <span class="math inline">\(\mathbb{X}\)</span> of size <span class="math inline">\(n \times (k + 1)\)</span> with <span class="math inline">\(x_{ij}\)</span> at row <span class="math inline">\(i\)</span> and column <span class="math inline">\(j\)</span> leading to <span class="math inline">\(\mathbf{y} = \mathbb{X} \boldsymbol{\beta} + \boldsymbol{\varepsilon}\)</span>.</li>
<li><strong>Warning:</strong> a regression is <em>linear</em> in the <span class="math inline">\(\boldsymbol{\beta}\)</span> <em>coefficients</em>, not in the predictors.</li>
</ul>
<h3 id="parameters-to-be-estimated">Parameters to be estimated</h3>
<ul>
<li>the regression coefficients <span class="math inline">\(\boldsymbol{\beta}\)</span>; and,</li>
<li>the common error variance term <span class="math inline">\(\sigma^2\)</span>.</li>
</ul>
<h3 id="how-to-estimate-the-best-parameters">How to estimate the <em>best</em> parameters?</h3>
<p><span class="math display">\[ \mbox{SSD}(\boldsymbol{\beta}, \sigma^2; \mathbf{y}, \mathbb{X}) := (\mathbf{y} - \mathbb{X} \boldsymbol{\beta})^\top (\mathbf{y} - \mathbb{X} \boldsymbol{\beta}) = \sum_{i = 1}^n (y_i - (\beta_0 + \beta_1 x_{i1} + \dots + \beta_k x_{ik}))^2 .\]</span></p>
</div>
</section>
<section id="the-case-of-categorical-predictors" class="slide level2">
<h2>The case of categorical predictors</h2>
<div class="r-fit-text">
<h3 id="if-a-predictor-is-categorical-how-do-we-fill-in-the-numeric-matrix-mathbbx">If a predictor is categorical, how do we fill in the numeric matrix <span class="math inline">\(\mathbb{X}\)</span>?</h3>
<h3 id="dummy-variables">Dummy variables</h3>
<ul>
<li><p>A categorical variable with <strong>two</strong> categories (<code>sex</code> for instance) can be transformed in a <strong>single</strong> numeric variable <code>sex == "male"</code>, which evaluates to <span class="math inline">\(1\)</span> if <code>sex</code> is <code>"male"</code> and to <span class="math inline">\(0\)</span> if <code>sex</code> is <code>"female"</code> (remember logicals are numbers in <code>R</code>).</p></li>
<li><p>A categorical variable with <strong>three</strong> categories (<code>origin</code> which stores the acronym of the New York airport for departure in the <code>flights</code> data set) can be converted into <strong>two</strong> numeric variables as shown in the table below:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th><code>origin</code></th>
<th><code>originJFK</code></th>
<th><code>originLGA</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>EWR</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>JFK</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>LGA</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
</section>
<section id="model-estimators" class="slide level2 smaller">
<h2>Model Estimators</h2>
<div class="r-fit-text">
<h3 id="estimator-of-the-coefficients-unbiased">Estimator of the coefficients (unbiased)</h3>
<p><span class="math display">\[ \widehat{\boldsymbol{\beta}} := (\mathbb{X}^T \mathbb{X})^{-1} \mathbb{X}^\top \mathbf{Y}, \]</span></p>
<h3 id="fitted-responses">Fitted responses</h3>
<p><span class="math display">\[ \widehat{\mathbf{Y}} = \mathbb{X} \widehat{\boldsymbol{\beta}} = \mathbb{X} (\mathbb{X}^T \mathbb{X})^{-1} \mathbb{X}^\top \mathbf{Y} = \mathbb{H} \mathbf{Y}. \]</span></p>
<h3 id="estimator-of-the-constant-variance-term-sigma2-unbiased">Estimator of the constant variance term <span class="math inline">\(\sigma^2\)</span> (unbiased)</h3>
<p><span class="math display">\[ \widehat{\sigma^2} := \frac{(\mathbf{Y} - \widehat{\mathbf{Y}})^\top (\mathbf{Y} - \widehat{\mathbf{Y}})}{n - k - 1}. \]</span></p>
</div>
</section>
<section id="hat-matrix-and-leverage" class="slide level2">
<h2>Hat matrix and leverage</h2>
<div class="r-fit-text">
<h3 id="hat-matrix-projection-matrix-influence-matrix">Hat matrix (<em>projection matrix</em>, <em>influence matrix</em>)</h3>
<p><span class="math display">\[ \mathbb{H} = \mathbb{X} (\mathbb{X}^T \mathbb{X})^{-1} \mathbb{X}^\top \]</span></p>
<h3 id="leverage">Leverage</h3>
<ul>
<li>The diagonal terms of <span class="math inline">\(\mathbb{H}\)</span> are such that <span class="math inline">\(0 \le h_{ii} \le 1\)</span>.</li>
<li><span class="math inline">\(h_{ii}\)</span> is called the <strong>leverage score</strong> of observation <span class="math inline">\((y_i, x_{i1}, \dots, x_{ik})\)</span>.</li>
<li>The leverage score does not depend on <span class="math inline">\(y_i\)</span> at all but only on the predictor values.</li>
<li>With some abuse of notation, we can write: <span class="math display">\[ h_{ii} = \frac{\partial \widehat{Y_i}}{\partial Y_i}, \]</span> which illustrates that the leverage measures the degree by which the <span class="math inline">\(i\)</span>-<em>th</em> measured value influences the <span class="math inline">\(i\)</span>-<em>th</em> fitted value.</li>
</ul>
</div>
</section>
<section id="residuals" class="slide level2">
<h2>Residuals</h2>
<div class="r-fit-text">
<ul>
<li><strong>Natural definition.</strong> Difference between observed and fitted response values: <span class="math display">\[ \widehat{\boldsymbol{\varepsilon}} := \mathbf{y} - \widehat{\mathbf{y}} = (\mathbb{I}_n - \mathbb{H}) \mathbf{y}. \]</span></li>
<li><span class="math inline">\(\mathbb{E}[\widehat{\boldsymbol{\varepsilon}}] = \mathbf{0}\)</span></li>
<li>Residuals do not have constant variance: <span class="math display">\[ \mathbb{V}\mbox{ar}[\widehat{\varepsilon}_i] = \sigma^2 (1 - h_{ii}). \]</span></li>
<li>Residuals are not uncorrelated: <span class="math display">\[ \mbox{Cov}(\widehat{\varepsilon}_i, \widehat{\varepsilon}_j) = -\sigma^2 h_{ij}, \mbox{ for } i \ne j. \]</span></li>
<li><strong>Standardized residuals.</strong> Residuals with almost constant variance (also known as <em>internally studentized residuals</em>): <span class="math display">\[ r_i := \frac{\widehat{\varepsilon}_i}{s(\widehat{\varepsilon}_i)} = \frac{\widehat{\varepsilon}_i}{\sqrt{\widehat{\sigma^2} \left( 1 - h_{ii} \right)}}. \]</span></li>
</ul>
</div>
</section>
<section id="studentized-residuals" class="slide level2">
<h2>Studentized residuals</h2>
<div class="r-fit-text">
<ul>
<li><strong>Definition.</strong> <strong>Studentized residuals</strong> for any given data point are calculated from a model fit to every other data point except the one in question. They are also called <em>externally studentized residuals</em>, <em>deleted residuals</em> or <em>jackknifed residuals</em>. <span class="math display">\[ t_i := \frac{y_i - \widehat{y}_i^{(-i)}}{\sqrt{\widehat{\sigma^2}^{(-i)} \left( 1 - h_{ii} \right)}} = r_i \left( \frac{n - k - 2}{n - k - 1 - r_i^2} \right)^{1/2}, \]</span> where <span class="math inline">\(n\)</span> is the total number of observations and <span class="math inline">\(k\)</span> is the number of predictors used in the model.</li>
<li><strong>Distribution.</strong> If the normality assumption of the original regression model is met, a studentized residual follows a Student’s t-distribution.</li>
<li><strong>Application.</strong> The motivation behind studentized residuals comes from their use in outlier testing. If we suspect a point is an outlier, then it was not generated from the assumed model, by definition. Therefore it would be a mistake – a violation of assumptions – to include that outlier in the fitting of the model. Studentized residuals are widely used in practical outlier detection.</li>
<li><strong>Source.</strong> <a href="https://stats.stackexchange.com/questions/204708/is-studentized-residuals-v-s-standardized-residuals-in-lm-model" class="uri">https://stats.stackexchange.com/questions/204708/is-studentized-residuals-v-s-standardized-residuals-in-lm-model</a></li>
</ul>
</div>
</section>
<section id="cooks-distance" class="slide level2">
<h2>Cook’s distance</h2>
<div class="r-fit-text">
<ul>
<li><strong>Definition.</strong> Cook’s distance <span class="math inline">\(D_i\)</span> of observation <span class="math inline">\(i\)</span> (for <span class="math inline">\(i = 1, \dots, n\)</span>) is defined as a scaled sum of squared differences between fitted values obtained by including or excluding that observation: <span class="math display">\[ D_i := \frac{ \sum_{j = 1}^{n} \left( \widehat{y}_j - \widehat{y}_j^{(-i)} \right)^2}{\widehat{\sigma^2} (k+1)} = \frac{r_i^2}{k+1} \frac{h_{ii}}{1-h_{ii}}. \]</span></li>
<li>If observation <span class="math inline">\(i\)</span> is an <strong>outlier</strong>, in the sense that it has probably been drawn from another distribution with respect to the other observations, then <span class="math inline">\(r_i\)</span> should be excessively high, which tends to increase Cook’s distance;</li>
<li>If observation <span class="math inline">\(i\)</span> has a lot of <strong>influence</strong> (high leverage score), then Cook’s distance increases.</li>
<li>You can have cases in which an observation might have high influence but is not necessarily an outlier and therefore should be kept for analysis.</li>
<li>The reverse can happen as well. Some points with low influence (low leverage score) can be outliers (high residual value). In this case, we could be tempted to remove the observation because it violates our assumption.</li>
<li>Cook’s distance does not help in the above two situations, but it does not really matter, because, in both cases, we can safely include the corresponding observation into our regression.</li>
</ul>
</div>
</section>
<section id="confidence-intervals" class="slide level2">
<h2>Confidence intervals</h2>
<div class="r-fit-text">
<h3 id="goal">Goal</h3>
<p>Compute a confidence interval for the mean response <span class="math inline">\(\mathbf{x}_i^\top \boldsymbol{\beta}\)</span> at an already observed point <span class="math inline">\(\mathbf{x}_i\)</span>, <span class="math inline">\(i=1,\dots,n\)</span>.</p>
<h3 id="point-estimator-of-mathbfx_itop-boldsymbolbeta">Point estimator of <span class="math inline">\(\mathbf{x}_i^\top \boldsymbol{\beta}\)</span></h3>
<p><span class="math display">\[ \mathbf{x}_i^\top \widehat{\boldsymbol{\beta}} \sim \mathcal{N} \left( \mathbf{x}_i^\top \boldsymbol{\beta}, \sigma^2 \mathbf{x}_i^\top (\mathbb{X}^\top \mathbb{X})^{-1} \mathbf{x}_i \right), \]</span></p>
<h3 class="build" id="point-estimator-of-sigma2">Point estimator of <span class="math inline">\(\sigma^2\)</span></h3>
<p>We do not know <span class="math inline">\(\sigma^2\)</span> but we have that: <span class="math display">\[ \frac{\widehat{\sigma^2}}{\sigma^2} \sim \chi^2(n-k-1), \]</span> and <span class="math inline">\(\widehat{\boldsymbol{\beta}}\)</span> and <span class="math inline">\(\widehat{\sigma^2}\)</span> are statistically independent.</p>
</div>
</section>
<section id="confidence-intervals-continued" class="slide level2">
<h2>Confidence intervals (<em>continued</em>)</h2>
<div class="r-fit-text">
<h3 id="pivotal-statistic">Pivotal statistic</h3>
<p>A <strong>pivotal statistic</strong> for a parameter <span class="math inline">\(\theta\)</span> is a random variable <span class="math inline">\(T(\theta)\)</span> such that</p>
<ul>
<li>the only unknown in its definition (computation) is the parameter that we aim at estimating,</li>
<li>the distribution of <span class="math inline">\(T(\theta)\)</span> is known and does not depend on the unknown parameter <span class="math inline">\(\theta\)</span>,</li>
</ul>
<p>When the parameter is the mean response <span class="math inline">\(\mathbf{x}_i^\top \boldsymbol{\beta}\)</span> at <span class="math inline">\(\mathbf{x}_i\)</span>, we can use the following pivotal statistic:</p>
<p><span class="math display">\[ \frac{\mathbf{x}_i^\top \boldsymbol{\beta} - \mathbf{x}_i^\top \widehat{\boldsymbol{\beta}}}{\sqrt{\widehat{\sigma^2} \mathbf{x}_i^\top (\mathbb{X}^\top \mathbb{X})^{-1} \mathbf{x}_i}} \sim \mathcal{S}tudent(n-k-1). \]</span></p>
<h3 id="construction-of-the-confidence-interval">Construction of the confidence interval</h3>
<p>We can express a <span class="math inline">\((1-\alpha)\%\)</span> <em>confidence</em> interval for the mean response <span class="math inline">\(\mathbf{x}_i^\top \boldsymbol{\beta}\)</span> at <span class="math inline">\(\mathbf{x}_i\)</span> as: <span class="math display">\[ \mathbb{P} \left( \mathbf{x}_i^\top \boldsymbol{\beta} \in \left[ \mathbf{x}_i^\top \widehat{\boldsymbol{\beta}} \pm t_{1-\frac{\alpha}{2}}(n-k-1) \sqrt{\widehat{\sigma^2} \mathbf{x}_i^\top (\mathbb{X}^\top \mathbb{X})^{-1} \mathbf{x}_i} \right] \right) = 1 - \alpha. \]</span></p>
</div>
</section>
<section id="prediction-intervals" class="slide level2">
<h2>Prediction intervals</h2>
<div class="r-fit-text">
<h3 id="goal-1">Goal</h3>
<p>Compute a prediction interval for a new not yet observed response <span class="math inline">\(Y_{n+1}\)</span> at a new observed point <span class="math inline">\(\mathbf{x}_{n+1}\)</span>: <span class="math display">\[ Y_{n+1} = \mathbf{x}_{n+1}^\top \boldsymbol{\beta} + \varepsilon_{n+1} \sim \mathcal{N} \left( \mathbf{x}_{n+1}^\top \boldsymbol{\beta}, \sigma^2 \right), \]</span></p>
<h3 id="point-estimator-of-y_n1">Point estimator of <span class="math inline">\(Y_{n+1}\)</span></h3>
<p><span class="math display">\[ \widehat{Y_{n+1}} = \mathbf{x}_{n+1}^\top \widehat{\boldsymbol{\beta}} \sim \mathcal{N}  \left( \mathbf{x}_{n+1}^\top \boldsymbol{\beta}, \sigma^2 \mathbf{x}_{n+1}^\top (\mathbb{X}^\top \mathbb{X})^{-1} \mathbf{x}_{n+1} \right), \]</span></p>
<h3 id="point-estimator-of-sigma2-1">Point estimator of <span class="math inline">\(\sigma^2\)</span></h3>
<p>We do not know <span class="math inline">\(\sigma^2\)</span> but we have that: <span class="math display">\[ \frac{\widehat{\sigma^2}}{\sigma^2} \sim \chi^2(n-k-1), \]</span> and <span class="math inline">\(\widehat{\boldsymbol{\beta}}\)</span> and <span class="math inline">\(\widehat{\sigma^2}\)</span> are statistically independent.</p>
</div>
</section>
<section id="prediction-intervals-continued" class="slide level2">
<h2>Prediction intervals (<em>continued</em>)</h2>
<div class="r-fit-text">
<h3 id="pivotal-statistic-1">Pivotal statistic</h3>
<p>We can now define a random variable of known distribution whose only unknown (once the <span class="math inline">\(n\)</span>-sample is observed) is <span class="math inline">\(Y_{n+1}\)</span>: <span class="math display">\[ \frac{Y_{n+1} - \widehat{Y_{n+1}}}{\sqrt{\widehat{\sigma^2} \left( 1 + \mathbf{x}_{n+1}^\top (\mathbb{X}^\top \mathbb{X})^{-1} \mathbf{x}_{n+1} \right)}} \sim \mathcal{S}tudent(n-k-1). \]</span></p>
<h3 id="construction-of-the-prediction-interval">Construction of the prediction interval</h3>
<p>We can express a <span class="math inline">\((1-\alpha)\%\)</span> <em>prediction</em> interval for the new not yet observed response <span class="math inline">\(Y_{n+1}\)</span> at <span class="math inline">\(\mathbf{x}_{n+1}\)</span> as: <span class="math display">\[ \mathbb{P} \left( Y_{n+1} \in \left[ \widehat{Y_{n+1}} \pm t_{1-\frac{\alpha}{2}}(n-k-1) \sqrt{\widehat{\sigma^2} \left( 1 + \mathbf{x}_{n+1}^\top (\mathbb{X}^\top \mathbb{X})^{-1} \mathbf{x}_{n+1} \right)} \right] \right) = 1 - \alpha. \]</span></p>
</div>
</section></section>
<section>
<section id="simple-models" class="title-slide slide level1 center">
<h1>Simple models</h1>

</section>
<section id="first-step-visualization" class="slide level2">
<h2>First step: Visualization</h2>
<div class="r-fit-text">
<p><strong>The most important first thing you should do before any modeling attempt is to look at your data.</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/nl-data-viz-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/nl-data-viz-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
<p>As you can see, both data sets seem to generate the same linear regression predictions, although we already clearly understand which one will go sideways…</p>
</div>
</section>
<section id="second-step-modeling" class="slide level2">
<h2>Second step: Modeling</h2>
<div class="r-fit-text">
<ul>
<li>We know the R function to fit linear regression models is <code>lm()</code>.</li>
<li>We have seen its syntax for simple models.</li>
<li>We have been introduced to the <a href="https://broom.tidymodels.org"><strong>broom</strong></a> package for retrieving relevant information from the output of <code>lm()</code>.</li>
<li>The <a href="https://broom.tidymodels.org/reference/glance.lm.html"><code>broom::glance()</code> help page</a> will provide you with a short summary of the information retrieved by <code>glance()</code>.</li>
<li>The <a href="https://broom.tidymodels.org/reference/tidy.lm.html"><code>broom::tidy()</code> help page</a> will provide you with a short summary of the information retrieved by <code>tidy()</code>.</li>
<li>The <a href="https://broom.tidymodels.org/reference/augment.lm.html"><code>broom::augment()</code> help page</a> will provide you with a short summary of the information retrieved by <code>augment()</code>.</li>
</ul>
</div>
</section>
<section id="third-step-model-diagnosis" class="slide level2">
<h2>Third step: Model Diagnosis</h2>
<div class="r-fit-text">
<p>You must always remember that, <strong>even though R facilitates computations, it does not verify for you that the assumptions required by the model are met by your data</strong>!</p>
<p>This is where <em>model diagnosis</em> comes into play. You can almost entirely diagnose your model graphically. Using the grammar of graphics in <code>ggplot2</code>, this can be achieved using the <a href="https://github.com/sinhrks/ggfortify"><code>ggfortify</code></a> package.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="co"># install.packages("ggfortify")</span></span>
<span id="cb1-2"><a></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb1-3"><a></a>first_model <span class="sc">|&gt;</span> </span>
<span id="cb1-4"><a></a>  <span class="fu">autoplot</span>(<span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">label.size =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb1-5"><a></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/install-ggfortify-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/install-ggfortify-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="reminder-model-assumptions" class="slide level2 scrollable">
<h2>Reminder: model assumptions</h2>
<div class="r-fit-text">
<p>Linear regression makes several assumptions about the data, such as :</p>
<ol type="1">
<li><p><strong>Linearity of the data</strong>. The relationship between the predictor (x) and the outcome (y) is assumed to be linear.</p></li>
<li><p><strong>Normality of residuals</strong>. The residual errors are assumed to be normally distributed.</p></li>
<li><p><strong>Homogeneity of residuals variance</strong>. The residuals are assumed to have a constant variance (<strong>homoscedasticity</strong>)</p></li>
<li><p><strong>Independence of residuals error terms</strong>.</p></li>
</ol>
<p>You should check whether or not these assumptions hold true. Potential problems include:</p>
<ol type="1">
<li><p><strong>Non-linearity</strong>&nbsp;of the outcome - predictor relationships</p></li>
<li><p><strong>Heteroscedasticity</strong>: Non-constant variance of error terms.</p></li>
<li><p><strong>Presence of influential values</strong>&nbsp;in the data that can be:</p>
<ul>
<li><p>Outliers: extreme values in the outcome (y) variable</p></li>
<li><p>High-leverage points: extreme values in the predictors (x) variable</p></li>
</ul></li>
</ol>
<p>All these assumptions and potential problems can be checked by producing some diagnostic plots visualizing the residual errors.</p>
<p>Source: <a href="http://www.sthda.com/english/articles/39-regression-model-diagnostics/161-linear-regression-assumptions-and-diagnostics-in-r-essentials/" class="uri">http://www.sthda.com/english/articles/39-regression-model-diagnostics/161-linear-regression-assumptions-and-diagnostics-in-r-essentials/</a></p>
</div>
</section>
<section id="first-data-set-residuals-vs-fitted-values" class="slide level2">
<h2>First data set: Residuals vs fitted values</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-1-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div title="Usage">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Usage</strong></p>
</div>
<div class="callout-content">
<p>To check for non-linearity not accounted for; a horizontal line, without distinct patterns is an indication for a linear relationship, which is good.</p>
</div>
</div>
</div>
</div>
</div></div>
</section>
<section id="first-data-set-normal-qq-plot" class="slide level2">
<h2>First data set: Normal QQ plot</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-2-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div title="Usage">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Usage</strong></p>
</div>
<div class="callout-content">
<p>To check the normality of residuals; good if residuals follow the straight dashed line.</p>
</div>
</div>
</div>
</div>
</div></div>
</section>
<section id="first-data-set-scale-location-plot" class="slide level2">
<h2>First data set: Scale-location plot</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-3-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div title="Usage">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Usage</strong></p>
</div>
<div class="callout-content">
<p>To check the homoscedasticity assumption (constant variance); horizontal line with equally spread points is a good indication of homoscedasticity.</p>
</div>
</div>
</div>
</div>
</div></div>
</section>
<section id="first-data-set-influential-points-outliers" class="slide level2">
<h2>First data set: Influential points, outliers</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-4-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
<div title="Usage">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Usage</strong></p>
</div>
<div class="callout-content">
<ul>
<li><p>To check the zero-mean assumption on the residuals and to spot potential outliers in the top and bottom right corners (residuals vs leverages plot)</p></li>
<li><p>To spot potential outliers as observations with the largest Cook’s distance.</p></li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="second-data-set-model-diagnosis" class="slide level2">
<h2>Second data set: Model diagnosis</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</section></section>
<section>
<section id="more-complex-models" class="title-slide slide level1 center">
<h1>More complex models</h1>

</section>
<section id="model-specification" class="slide level2">
<h2>Model specification</h2>
<div class="r-fit-text">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> response <span class="sc">~</span> predictors, <span class="at">data =</span> fancy_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The left-hand side of <code>~</code> must contain the response variable as named in the atomic vector storing its values or in the data set containing it.</p>
<p>The right-hand side specifies the predictors and will therefore be a combination of potentially transformed variables from your data set (or from atomic vectors defined in your R environment). To get the proper syntax for the rhs of the formula, you should be know the set of allowed operators that have a specific interpretation by R when used within a formula:</p>
<ul>
<li><code>+</code> for adding terms.</li>
<li><code>-</code> for removing terms.</li>
<li><code>:</code> for adding interaction terms only.</li>
<li><code>*</code> for crossing variables, <em>i.e.</em> adding variables and their interactions.</li>
<li><code>%in%</code> for nesting variables, <em>i.e.</em> adding one variable and its interaction with another.</li>
<li><code>^</code> for limiting variable crossing to a specified order</li>
<li><code>.</code> for adding all other variables in the matrix that have not yet been included in the model.</li>
</ul>
</div>
</section>
<section id="model-specification-continued" class="slide level2">
<h2>Model specification (<em>continued</em>)</h2>
<div class="r-fit-text">
<p>Linear regression assumes that the response variable (<code>y</code>) and at least one predictor (<code>x</code>) are continuous variables. The following table summarizes the effect of operators when adding a variable <code>z</code> to the predictors. When <code>z</code> is categorical, we assume that it can take <span class="math inline">\(h\)</span> unique possible values <span class="math inline">\(z_0, z_1, \dots, z_{h-1}\)</span>.</p>
<table class="caption-top">
<colgroup>
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>Type of <code>z</code></th>
<th>Formula</th>
<th>Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Continuous</td>
<td><code>y ~ x + z</code></td>
<td><span class="math inline">\(Y = \beta_0 + \beta_1 x + \beta_2 z + \varepsilon\)</span></td>
</tr>
<tr class="even">
<td>Continuous</td>
<td><code>y ~ x : z</code></td>
<td><span class="math inline">\(Y = \beta_0 + \beta_1 x z + \varepsilon\)</span></td>
</tr>
<tr class="odd">
<td>Continuous</td>
<td><code>y ~ x * z</code></td>
<td><span class="math inline">\(Y = \beta_0 + \beta_1 x + \beta_2 z + \beta_3 x z + \varepsilon\)</span></td>
</tr>
<tr class="even">
<td>Categorical</td>
<td><code>y ~ x + z</code></td>
<td><span class="math inline">\(Y = \beta_0^{(0)} + \sum_{\ell = 1}^{h-1} \beta_\ell^{(0)} \delta_{\{z = z_\ell\}} + \beta_1^{(1)} x + \varepsilon\)</span></td>
</tr>
<tr class="odd">
<td>Categorical</td>
<td><code>y ~ x : z</code></td>
<td><span class="math inline">\(Y = \beta_0^{(0)} + \beta_1^{(1)} x + \sum_{\ell = 1}^{h-1} \beta_\ell^{(1)} x \delta_{\{z = z_\ell\}} + \varepsilon\)</span></td>
</tr>
<tr class="even">
<td>Categorical</td>
<td><code>y ~ x * z</code></td>
<td><span class="math inline">\(Y = \beta_0^{(0)} + \sum_{\ell = 1}^{h-1} \beta_\ell^{(0)} \delta_{\{z = z_\ell\}} + \beta_0^{(1)} x + \sum_{\ell = 1}^{h-1} \beta_\ell^{(1)} x \delta_{\{z = z_\ell\}} + \varepsilon\)</span></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="i" class="slide level2">
<h2><code>I()</code></h2>
<div class="r-fit-text">
<p>What strikes from the previous table is that the natural multiplication of variables <em>within a formula</em> does not simply adds the product of the predictors in the model but also the predictors themselves.</p>
<p>What if you want to actually perform an arithmetic operation on your predictors to include a transformed predictor in your model? For example, you might want to include both <span class="math inline">\(x\)</span> and <span class="math inline">\(x^2\)</span> in your model. You have two options:</p>
<blockquote>

<ul>
<li>You compute all of the (possibly transformed) predictors you want to include in your model beforehand and store them in the data set (remember <code>dplyr::mutate()</code> which will help you achieve this goal easily); or,</li>
<li>You use the <em>as-is</em> operator <code>I()</code>. In this case, you instruct <code>lm()</code> that the operations declared within <code>I()</code> must be performed outside from the formula environment and before generating the design matrix for the model.</li>
</ul>

</blockquote>
</div>
</section>
<section id="effective-model-summaries" class="slide level2">
<h2>Effective Model Summaries</h2>
<div class="r-fit-text">
<p>There are two possible software suites:</p>
<ul>
<li>either <a href="https://jtools.jacob-long.com/index.html"><code>jtools</code></a> and <a href="https://interactions.jacob-long.com"><code>interactions</code></a> packages:</li>
<li>or <a href="https://strengejacke.github.io/ggeffects/index.html"><code>ggeffects</code></a> and <a href="https://strengejacke.github.io/sjPlot/"><code>sjPlot</code></a> packages.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="co"># install.packages(c("jtools", "interactions"))</span></span>
<span id="cb3-2"><a></a><span class="co"># install.packages(c("ggeffects", "sjPlot"))</span></span>
<span id="cb3-3"><a></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(metascore <span class="sc">~</span> imdb_rating <span class="sc">+</span> <span class="fu">log</span>(us_gross) <span class="sc">+</span> genre5, <span class="at">data =</span> jtools<span class="sc">::</span>movies)</span>
<span id="cb3-4"><a></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(metascore <span class="sc">~</span> imdb_rating <span class="sc">+</span> <span class="fu">log</span>(us_gross) <span class="sc">+</span> <span class="fu">log</span>(budget) <span class="sc">+</span> genre5, <span class="at">data =</span> jtools<span class="sc">::</span>movies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>They both provide tools for summarizing and visualising models, marginal effects, interactions and model predictions.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>jtools<span class="sc">::</span><span class="fu">summ</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Observations</td>
<td style="text-align: right;">831 (10 missing obs. deleted)</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Dependent variable</td>
<td style="text-align: right;">metascore</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Type</td>
<td style="text-align: right;">OLS linear regression</td>
</tr>
</tbody>
</table>
</div>
 
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">F(6,824)</td>
<td style="text-align: right;">169.37</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">R²</td>
<td style="text-align: right;">0.55</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Adj. R²</td>
<td style="text-align: right;">0.55</td>
</tr>
</tbody>
</table>
</div>
 
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Est.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">S.E.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t val.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">(Intercept)</td>
<td style="text-align: right;">-39.96</td>
<td style="text-align: right;">5.92</td>
<td style="text-align: right;">-6.75</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">imdb_rating</td>
<td style="text-align: right;">12.80</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">25.89</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">log(us_gross)</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">0.13</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">genre5Comedy</td>
<td style="text-align: right;">6.32</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">5.95</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">genre5Drama</td>
<td style="text-align: right;">7.66</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">7.12</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">genre5Horror/Thriller</td>
<td style="text-align: right;">-0.73</td>
<td style="text-align: right;">1.51</td>
<td style="text-align: right;">-0.48</td>
<td style="text-align: right;">0.63</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">genre5Other</td>
<td style="text-align: right;">5.86</td>
<td style="text-align: right;">3.25</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">0.07</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> Standard errors: OLS</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>jtools<span class="sc">::</span><span class="fu">plot_summs</span>(fit, fit2, <span class="at">inner_ci_level =</span> .<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</div>
</section>
<section id="effect-plot---continuous-predictor" class="slide level2">
<h2>Effect plot - Continuous predictor</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(cty <span class="sc">~</span> displ <span class="sc">+</span> year <span class="sc">+</span> cyl <span class="sc">+</span> class <span class="sc">+</span> fl, <span class="at">data =</span> mpg)</span>
<span id="cb6-2"><a></a>fit_poly <span class="ot">&lt;-</span> <span class="fu">lm</span>(cty <span class="sc">~</span> <span class="fu">poly</span>(displ, <span class="dv">2</span>) <span class="sc">+</span> year <span class="sc">+</span> cyl <span class="sc">+</span> class <span class="sc">+</span> fl, <span class="at">data =</span> mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>jtools<span class="sc">::</span><span class="fu">effect_plot</span>(fit, <span class="at">pred =</span> displ, <span class="at">interval =</span> <span class="cn">TRUE</span>, <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>jtools<span class="sc">::</span><span class="fu">effect_plot</span>(fit_poly, <span class="at">pred =</span> displ, <span class="at">interval =</span> <span class="cn">TRUE</span>, <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-11-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>jtools<span class="sc">::</span><span class="fu">effect_plot</span>(fit, <span class="at">pred =</span> displ, <span class="at">interval =</span> <span class="cn">TRUE</span>, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-12-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-12-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>jtools<span class="sc">::</span><span class="fu">effect_plot</span>(fit_poly, <span class="at">pred =</span> displ, <span class="at">interval =</span> <span class="cn">TRUE</span>, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="effect-plot---categorical-predictor" class="slide level2">
<h2>Effect plot - Categorical predictor</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a>jtools<span class="sc">::</span><span class="fu">effect_plot</span>(fit, <span class="at">pred =</span> fl, <span class="at">interval =</span> <span class="cn">TRUE</span>, <span class="at">partial.residuals =</span> <span class="cn">TRUE</span>, <span class="at">jitter =</span> .<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img data-src="11-Linear-Modeling-Slides_files/figure-revealjs/unnamed-chunk-14-1.png" class="quarto-figure quarto-figure-center" width="960"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interaction-plots" class="slide level2">
<h2>Interaction plots</h2>
<p>This is handled by the <code>interaction</code> package.</p>
<ul>
<li><p>Johnson-Neyman plot: <a href="https://interactions.jacob-long.com/index.html"><code>sim_slopes()</code></a></p></li>
<li><p>Two-way interaction with at least one continuous predictor: <a href="https://interactions.jacob-long.com/articles/interactions.html"><code>interact_plot()</code></a></p></li>
<li><p>Two-way interaction between categorical predictors: <a href="https://interactions.jacob-long.com/articles/categorical.html"><code>cat_plot()</code></a></p></li>
</ul>
</section>
<section id="collinearity-multicollinearity" class="slide level2">
<h2>Collinearity &amp; Multicollinearity</h2>
<ul>
<li><p>(Multi)-collinearity refers to high correlation in two or more independent variables in the regression model.</p></li>
<li><p>Multicollinearity can arise from poorly designed experiments (Data-based multicollinearity) or from creating new independent variables related to the existing ones (structural multicollinearity).</p></li>
<li><p><em>Correlation plots</em> are a great tool to explore colinearity between two variables. They can be seamlessly computed and visualized using packages such as <a href="https://corrr.tidymodels.org/index.html"><code>corrr</code></a> or <a href="https://rpkgs.datanovia.com/ggcorrplot/index.html"><code>ggcorrplot</code></a>.</p></li>
</ul>
</section>
<section id="variation-inflation-factor-13" class="slide level2">
<h2>Variation Inflation Factor (1/3)</h2>
<p>The Variance inflation factor (VIF) measures the degree of multicollinearity or collinearity in the regression model.</p>
<p><span class="math display">\[
\mathrm{VIF}_i = \frac{1}{1 - R_i^2},
\]</span></p>
<p>where <span class="math inline">\(R_i^2\)</span> is the multiple correlation coefficient associated to the regression of <span class="math inline">\(X_i\)</span> against all remaining independent variables.</p>
</section>
<section id="variation-inflation-factor-23" class="slide level2">
<h2>Variation Inflation Factor (2/3)</h2>
<p>You can add VIFs to the summary of a model as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a>jtools<span class="sc">::</span><span class="fu">summ</span>(fit, <span class="at">vifs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Observations</td>
<td style="text-align: right;">234</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Dependent variable</td>
<td style="text-align: right;">cty</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Type</td>
<td style="text-align: right;">OLS linear regression</td>
</tr>
</tbody>
</table>
</div>
 
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">F(13,220)</td>
<td style="text-align: right;">100.37</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">R²</td>
<td style="text-align: right;">0.86</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Adj. R²</td>
<td style="text-align: right;">0.85</td>
</tr>
</tbody>
</table>
</div>
 
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Est.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">S.E.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t val.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VIF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">(Intercept)</td>
<td style="text-align: right;">-199.79</td>
<td style="text-align: right;">51.14</td>
<td style="text-align: right;">-3.91</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">displ</td>
<td style="text-align: right;">-1.02</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">-3.53</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">11.76</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">year</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">4.52</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.11</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">cyl</td>
<td style="text-align: right;">-0.85</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">-4.26</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">8.69</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">classcompact</td>
<td style="text-align: right;">-2.81</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-2.83</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">3.69</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">classmidsize</td>
<td style="text-align: right;">-2.95</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">-3.05</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.69</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">classminivan</td>
<td style="text-align: right;">-5.08</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">-4.82</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.69</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">classpickup</td>
<td style="text-align: right;">-5.89</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">-6.37</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.69</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">classsubcompact</td>
<td style="text-align: right;">-2.63</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">-2.61</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">3.69</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">classsuv</td>
<td style="text-align: right;">-5.59</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">-6.33</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.69</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">fld</td>
<td style="text-align: right;">5.93</td>
<td style="text-align: right;">1.85</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.60</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">fle</td>
<td style="text-align: right;">-5.13</td>
<td style="text-align: right;">1.81</td>
<td style="text-align: right;">-2.84</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.60</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">flp</td>
<td style="text-align: right;">-2.97</td>
<td style="text-align: right;">1.72</td>
<td style="text-align: right;">-1.73</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">1.60</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">flr</td>
<td style="text-align: right;">-1.69</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">-0.99</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">1.60</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> Standard errors: OLS</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>
</div>
</div>
</div>
</section>
<section id="variation-inflation-factor-33" class="slide level2">
<h2>Variation Inflation Factor (3/3)</h2>
<div class="r-fit-text">
<ul>
<li><p>VIFs are always at least equal to 1.</p></li>
<li><p>In some domains, VIF over 2 is worthy of suspicion. Others set the bar higher, at 5 or 10. Others still will say you shouldn’t pay attention to these at all. Ultimately, the main thing to consider is that small effects are more likely to be “drowned out” by higher&nbsp;VIFs, but this may just be a natural, unavoidable fact with your model (e.g., there is no problem with high&nbsp;VIFs&nbsp;when you have an interaction effect).</p></li>
<li><p>Should you care?</p>
<ul>
<li><p>If you are interested in causal inference, yes;</p></li>
<li><p>otherwise, no.</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="model-selection" class="slide level2">
<h2>Model selection</h2>
<div class="r-fit-text">
<ul>
<li><strong>Forward selection</strong>, which involves starting with no variables in the model, testing the addition of each variable using a chosen model fit criterion, adding the variable (if any) whose inclusion gives the most statistically significant improvement of the fit, and repeating this process until none improves the model to a statistically significant extent.</li>
<li><strong>Backward elimination</strong>, which involves starting with all candidate variables, testing the deletion of each variable using a chosen model fit criterion, deleting the variable (if any) whose loss gives the most statistically insignificant deterioration of the model fit, and repeating this process until no further variables can be deleted without a statistically significant loss of fit.</li>
<li>A list of possible and often used model fit criterion is available on the <a href="https://en.wikipedia.org/wiki/Model_selection">Wikipedia Model Selection</a> page. In R, the basic <code>stats::step()</code> function uses the Akaike’s information criterion (AIC) and allows to perform forward selection (<code>direction = "forward"</code>) or backward elimination (<code>direction = "backward"</code>).</li>
</ul>
</div>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../logo-lmjl.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>Data Science with R - <a href="mailto:aymeric.stamm@cnrs.fr" class="email">aymeric.stamm@cnrs.fr</a> - <a href="https://astamm.github.io/data-science-with-r/" class="uri">https://astamm.github.io/data-science-with-r/</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/astamm\.github\.io\/data-science-with-r\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
            // Handle positioning of the toggle
        window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
        );
        function throttle(fn, ms) {
        let throttle = false;
        let timer;
          return (...args) => {
            if(!throttle) { // first call gets through
                fn.apply(this, args);
                throttle = true;
            } else { // all the others get throttled
                if(timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
            }
          };
        }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              trigger: 'click',
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              positionFixed: true,
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>
    

</body></html>