<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Aymeric Stamm">
  <meta name="date" content="2025-09-05">
  <title>Data Science with R ‚Äì Principal Component Analysis</title>
  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" type="text/css" media="screen, projection, print" href="https://www.w3.org/Talks/Tools/Slidy2/styles/slidy.css">
  <link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
  <script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
  <link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
  <script src="../site_libs/datatables-binding-0.34.0/datatables.js"></script>
  <script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
  <link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
  <script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
  <link href="../site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
  <script src="../site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
  <script src="https://www.w3.org/Talks/Tools/Slidy2/scripts/slidy.js" charset="utf-8" type="text/javascript"></script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Principal Component Analysis</h1>
  <p class="author">
Aymeric Stamm
  </p>
  <p class="date">2025-09-05</p>
</div>
<div id="overview" class="title-slide slide section level1">
<h1>Overview</h1>

</div>
<div id="dimensionality-reduction" class="slide section level2">
<h1>Dimensionality reduction</h1>
<p>If you‚Äôve worked with a lot of variables before, you know this can present problems. Do you understand the relationships between each variable? Do you have so many variables that you are in danger of overfitting your model to your data or that you might be violating assumptions of whichever modeling tactic you‚Äôre using?</p>
<p>You might ask the question, ‚ÄúHow do I take all of the variables I‚Äôve collected and focus on only a few of them?‚Äù In technical terms, you want to ‚Äúreduce the dimension of your feature space.‚Äù By reducing the dimension of your feature space, you have fewer relationships between variables to consider and you are less likely to overfit your model.</p>
<p>Think about linear regression:</p>
<ul>
<li>multicollinearity issues;</li>
<li>difficult to use strategies like backward elimination.</li>
</ul>
</div>
<div id="pca" class="slide section level2">
<h1>PCA</h1>
<p><strong>What ?</strong></p>
<p>Principal component analysis is a technique for feature extraction ‚Äî so it combines our input variables in a specific way, then we can drop the ‚Äúleast important‚Äù variables while still retaining the most valuable parts of all of the variables! As an added benefit, each of the ‚Äúnew‚Äù variables after PCA are all independent of one another.</p>
<p><strong>How ?</strong></p>
<p>The dimension reduction is achieved by identifying the principal directions, called <strong>principal components</strong>, in which the data varies.</p>
<p>PCA assumes that the directions with the largest variances are the most ‚Äúimportant‚Äù (i.e, the most principal).</p>
<p><strong>When to use?</strong></p>
<ol style="list-style-type: decimal">
<li>Do you want to reduce the number of variables, but aren‚Äôt able to identify variables to completely remove from consideration?</li>
<li>Do you want to ensure your variables are independent of one another?</li>
<li>Are you comfortable making your independent variables less interpretable?</li>
</ol>
</div>
<div id="principle" class="slide section level2">
<h1>Principle</h1>
<!-- ![](https://builtin.com/sites/default/files/inline-images/Principal%20Component%20Analysis%20second%20principal.gif) -->
<p><img src="pca-principle.gif"></p>
<ul>
<li>The 1st principal component (PC) accounts for the largest possible variance in the data set;</li>
<li>i.e.&nbsp;the line in which the projection of the points (red dots) is the most spread out.</li>
<li>The second PC is uncorrelated to the 1st PC and maximizes the remaining variance;</li>
<li>etc.</li>
</ul>
</div>
<div id="mathematical-formalism" class="slide section level2">
<h1>Mathematical formalism</h1>
<div style="float: left; width: 50%;">
<p><strong>Context.</strong></p>
<p><span class="math inline"><strong>X</strong><sub>1</sub>,‚ÄÜ‚Ä¶,‚ÄÜ<strong>X</strong><sub><em>n</em></sub></span> a sample of <span class="math inline"><em>n</em></span> <em>i.i.d.</em> random vectors in <span class="math inline">‚Ñù<sup><em>p</em></sup></span>. Let <span class="math inline">ùïè‚ÄÑ=‚ÄÑ(<strong>X</strong><sub>1</sub>,‚ÄÜ‚Ä¶,‚ÄÜ<strong>X</strong><sub><em>n</em></sub>)<sup>‚ä§</sup></span> be the <span class="math inline"><em>n</em>‚ÄÖ√ó‚ÄÖ<em>p</em></span> data matrix, whose <span class="math inline"><em>j</em></span>-<em>th</em> column is the vector <span class="math inline"><strong>x</strong><sub><em>j</em></sub></span> containing the <span class="math inline"><em>n</em></span> observations on the <span class="math inline"><em>j</em></span>-<em>th</em> variable. Let <span class="math inline"><em>Œ£</em></span> be the covariance structure of the <span class="math inline"><strong>X</strong><sub><em>i</em></sub></span>‚Äôs.</p>
<p><strong>Determination of the 1st PC</strong></p>
<p>The 1st principal component (PC) accounts for the largest possible variance in the data set.</p>
<ul class="incremental">
<li>Search a linear projection <span class="math inline"><strong>a</strong>‚ÄÑ‚àà‚ÄÑ‚Ñù<sup><em>p</em></sup></span> of the original variables (columns of <span class="math inline">ùïè</span>) with maximal variance. Such projection reads <span class="math inline">ùïè<strong>a</strong></span> of which each component has variance: <span class="math display">Var([ùïè<strong>a</strong>]<sub><em>i</em></sub>)‚ÄÑ=‚ÄÑ<strong>a</strong><sup>‚ä§</sup><em>Œ£</em><strong>a</strong>.</span></li>
</ul>
</div>
<div style="float: left; width: 50%;">
<ul class="incremental">
<li>Requires additional constraint because maximum does not exist in <span class="math inline">‚Ñù<sup><em>p</em></sup></span>: search for <span class="math inline">‚à•<strong>a</strong>‚à•‚ÄÑ=‚ÄÑ1</span>.</li>
<li>The sample covariance <span class="math inline"><em>S</em></span> is an unbiased estimator of <span class="math inline"><em>Œ£</em></span>, hence we can instead solve: <span class="math display">$$ \max_{\mathbf{a} \in \mathcal{S}^{p-1}} \mathbf{a}^\top S \mathbf{a} = \max_{\mathbf{a} \in \mathbb{R}^p} \frac{\mathbf{a}^\top S \mathbf{a}}{\mathbf{a}^\top \mathbf{a}} $$</span></li>
<li>Solution is eigenvector of <span class="math inline"><em>S</em></span> associated to the largest eigenvalue:
<ul class="incremental">
<li>constrained problem is equivalent to maximizing <span class="math inline"><strong>a</strong><sup>‚ä§</sup><em>S</em><strong>a</strong>‚ÄÖ‚àí‚ÄÖ<em>Œª</em>(<strong>a</strong><sup>‚ä§</sup><strong>a</strong>‚ÄÖ‚àí‚ÄÖ1)</span>;</li>
<li>differentiation leads to <span class="math inline"><em>S</em><strong>a</strong>‚ÄÑ=‚ÄÑ<em>Œª</em><strong>a</strong></span>; hence, <span class="math inline"><strong>a</strong></span> is an eigenvector of <span class="math inline"><em>S</em></span>;</li>
<li>hence we get <span class="math inline"><strong>a</strong><sup>‚ä§</sup><em>S</em><strong>a</strong>‚ÄÑ=‚ÄÑ<em>Œª</em></span> which means that <span class="math inline"><em>Œª</em></span> must be the largest eigenvalue of <span class="math inline"><em>S</em></span> in order to maximize <span class="math inline"><strong>a</strong><sup>‚ä§</sup><em>S</em><strong>a</strong></span>.</li>
</ul></li>
</ul>
</div>
</div>
<div id="r-packages" class="slide section level2 build">
<h1 class="build">R Packages</h1>
<h3 id="principal-component-computation">Principal Component Computation</h3>
<ul>
<li><code>prcomp()</code> and <code>princomp()</code> from built-in R <strong>stats</strong> package,</li>
<li><code>PCA()</code> from <a href="https://factominer.free.fr"><strong>FactoMineR</strong></a> package,</li>
<li><code>dudi.pca()</code> from <a href="https://pbil.univ-lyon1.fr/ade4/home.php?lang=eng"><strong>ade4</strong></a> package.</li>
</ul>
<h3 id="recommendation">Recommendation</h3>
<p>The <code>FactoMineR::PCA()</code> function.</p>
<h3 id="information-extraction-and-visualization">Information Extraction and Visualization</h3>
<p>The <strong>factoextra</strong> package.</p>
</div>
<div id="case-study" class="slide section level2">
<h1>Case Study</h1>
<ul>
<li>Athletes‚Äô performance during two sporting events (Decastar and OlympicG)</li>
<li>It contains <span class="math inline">41</span> individuals (athletes) described by <span class="math inline">13</span> variables.</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-4c2738c62d342716726f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4c2738c62d342716726f">{"x":{"filter":"none","vertical":false,"data":[["SEBRLE","CLAY","KARPOV","BERNARD","YURKOV","WARNERS","ZSIVOCZKY","McMULLEN","MARTINEAU","HERNU","BARRAS","NOOL","BOURGUIGNON","Sebrle","Clay","Karpov","Macey","Warners","Zsivoczky","Hernu","Nool","Bernard","Schwarzl","Pogorelov","Schoenbeck","Barras","Smith","Averyanov","Ojaniemi","Smirnov","Qi","Drews","Parkhomenko","Terek","Gomez","Turi","Lorenzo","Karlivans","Korkizoglou","Uldal","Casarsa"],[11.04,10.76,11.02,11.02,11.34,11.11,11.13,10.83,11.64,11.37,11.33,11.33,11.36,10.85,10.44,10.5,10.89,10.62,10.91,10.97,10.8,10.69,10.98,10.95,10.9,11.14,10.85,10.55,10.68,10.89,11.06,10.87,11.14,10.92,11.08,11.08,11.1,11.33,10.86,11.23,11.36],[7.58,7.4,7.3,7.23,7.09,7.6,7.3,7.31,6.81,7.56,6.97,7.27,6.8,7.84,7.96,7.81,7.47,7.74,7.14,7.19,7.53,7.48,7.49,7.31,7.3,6.99,6.81,7.34,7.5,7.07,7.34,7.38,6.61,6.94,7.26,6.91,7.03,7.26,7.07,6.99,6.68],[14.83,14.26,14.77,14.25,15.19,14.31,13.48,13.76,14.57,14.41,14.09,12.68,13.46,16.36,15.23,15.93,15.73,14.48,15.31,14.65,14.26,14.8,14.01,15.1,14.77,14.91,15.24,14.44,14.97,13.88,13.55,13.07,15.69,15.15,14.57,13.62,13.22,13.3,14.81,13.53,14.92],[2.07,1.86,2.04,1.92,2.1,1.98,2.01,2.13,1.95,1.86,1.95,1.98,1.86,2.12,2.06,2.09,2.15,1.97,2.12,2.03,1.88,2.12,1.94,2.06,1.88,1.94,1.91,1.94,1.94,1.94,1.97,1.88,2.03,1.94,1.85,2.03,1.85,1.97,1.94,1.85,1.94],[49.81,49.37,48.37,48.93,50.42,48.68,48.62,49.91,50.14,51.1,49.48,49.2,51.16,48.36,49.19,46.81,48.97,47.97,49.4,48.73,48.81,49.13,49.76,50.79,50.3,49.41,49.27,49.72,49.12,49.11,49.65,48.51,51.04,49.56,48.61,51.67,49.34,50.54,51.16,50.95,53.2],[14.69,14.05,14.09,14.99,15.31,14.23,14.17,14.38,14.93,15.06,14.48,15.29,15.67,14.05,14.13,13.97,14.56,14.01,14.95,14.25,14.8,14.17,14.25,14.21,14.34,14.37,14.01,14.39,15.01,14.77,14.78,14.01,14.88,15.12,14.41,14.26,15.38,14.98,14.96,15.09,15.39],[43.75,50.72,48.95,40.87,46.26,41.1,45.67,44.41,47.6,44.99,42.1,37.92,40.49,48.72,50.11,51.65,48.34,43.73,45.62,44.72,42.05,44.75,42.43,44.6,44.41,44.83,49.02,39.88,40.35,42.47,45.13,40.11,41.9,45.62,40.95,39.83,40.22,43.34,46.07,43.01,48.66],[5.02,4.92,4.92,5.32,4.72,4.92,4.42,4.42,4.92,4.82,4.72,4.62,5.02,5,4.9,4.6,4.4,4.9,4.7,4.8,5.4,4.4,5.1,5,5,4.6,4.2,4.8,4.6,4.7,4.5,5,4.8,5.3,4.4,4.8,4.5,4.5,4.7,4.5,4.4],[63.19,60.15,50.31,62.77,63.44,51.77,55.37,56.37,52.33,57.19,55.4,57.44,54.68,70.52,69.70999999999999,55.54,58.46,55.39,63.45,57.76,61.33,55.27,56.32,53.45,60.89,64.55,61.52,54.51,59.26,60.88,60.79,51.53,65.81999999999999,50.62,60.71,59.34,58.36,52.92,53.05,60,58.62],[291.7,301.5,300.2,280.1,276.4,278.1,268,285.1,262.1,285.1,282,266.6,291.7,280.01,282,278.11,265.42,278.05,269.54,264.35,276.33,276.31,273.56,287.63,278.82,267.09,272.74,271.02,275.71,263.31,272.63,274.21,277.94,290.36,269.7,290.01,263.08,278.67,317,281.7,296.12],[1,2,3,4,5,6,7,8,9,10,11,12,13,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],[8217,8122,8099,8067,8036,8030,8004,7995,7802,7733,7708,7651,7313,8893,8820,8725,8414,8343,8287,8237,8235,8225,8102,8084,8077,8067,8023,8021,8006,7993,7934,7926,7918,7893,7865,7708,7592,7583,7573,7495,7404],["Decastar","Decastar","Decastar","Decastar","Decastar","Decastar","Decastar","Decastar","Decastar","Decastar","Decastar","Decastar","Decastar","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG","OlympicG"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>100m<\/th>\n      <th>Long.jump<\/th>\n      <th>Shot.put<\/th>\n      <th>High.jump<\/th>\n      <th>400m<\/th>\n      <th>110m.hurdle<\/th>\n      <th>Discus<\/th>\n      <th>Pole.vault<\/th>\n      <th>Javeline<\/th>\n      <th>1500m<\/th>\n      <th>Rank<\/th>\n      <th>Points<\/th>\n      <th>Competition<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"searching":false,"lengthMenu":[5,10,15,20],"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"100m","targets":1},{"name":"Long.jump","targets":2},{"name":"Shot.put","targets":3},{"name":"High.jump","targets":4},{"name":"400m","targets":5},{"name":"110m.hurdle","targets":6},{"name":"Discus","targets":7},{"name":"Pole.vault","targets":8},{"name":"Javeline","targets":9},{"name":"1500m","targets":10},{"name":"Rank","targets":11},{"name":"Points","targets":12},{"name":"Competition","targets":13}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="objectives" class="slide section level2 build">
<h1 class="build">Objectives</h1>
<p>PCA allows to describe a data set, to summarize a data set, to reduce the dimensionality. We want to perform a PCA on all the individuals of the data set to answer several questions:</p>
<h4 id="individuals-study-athletes-study">Individuals‚Äô study (athletes‚Äô study)</h4>
<p>Two athletes will be close to each other if their results to the events are close. We want to see the variability between the individuals.</p>
<ul>
<li>Are there similarities between individuals for all the variables?</li>
<li>Can we establish different profiles of individuals?</li>
<li>Can we oppose a group of individuals to another one?</li>
</ul>
<h4 id="variables-study-performances-study">Variables‚Äô study (performances‚Äô study)</h4>
<p>We want to see if there are linear relationships between variables. The two objectives are to summarize the correlation matrix and to look for synthetic variables: can we resume the performance of an athlete by a small number of variables?</p>
<h4 id="link-between-this-two-studies">Link between this two studies</h4>
<p>Can we characterize groups of individuals by variables?</p>
</div>
<div id="pca-terminology" class="slide section level2">
<h1>PCA Terminology</h1>
<div style="float: left; width: 55%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img src="pca-decathlon.png" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div style="float: right; width: 45%;">
<p><em>Active individuals</em>: Individuals used for PCA.</p>
<p><em>Supplementary individuals</em>: Coordinates of these individuals will be predicted using the PCA information and parameters obtained using active individuals.</p>
<p><em>Active variables</em>: Variables used for PCA.</p>
<p><em>Supplementary variables</em>: Coordinates of these variables will be predicted also. These can be:</p>
<ul>
<li><em>Supplementary continuous variables</em>: Cols 11 and 12 correspond respectively to the rank and the points of athletes.</li>
<li><em>Supplementary qualitative variables</em>: Col 13 corresponds to the two athletic meetings (2004 Olympic Game or 2004 Decastar). This is a categorical variable. It can be used to color individuals by groups.</li>
</ul>
</div>
</div>
<div id="data-standardization" class="slide section level2 build">
<h1 class="build">Data standardization</h1>
<h3 id="description-of-the-problem">Description of the problem</h3>
<ul>
<li><p>PCA linearly combines original variables to maximize variance</p></li>
<li><p>If one variable is measured in meter and another in centimeter, the first one will contribute more to the variance than the second one, even if the <em>intrinsic</em> variability of each variable is the same.</p></li>
</ul>
<div style="color: red; text-align: center;">
<p><font style="font-size: larger;"> <span class="math inline">‚áí</span> We need to scale the variables prior to performing PCA! </font></p>
</div>
<h3 id="a-common-solution-standardization">A common solution: Standardization</h3>
<p><span class="math display">$$ x_{ij} \leftarrow \frac{x_{ij} - \overline{x}_j}{\sqrt{\frac{1}{n-1} \sum_{\ell=1}^n (x_{\ell j} - \overline{x}_j)^2}} $$</span></p>
<div style="color: green; text-align: center;">
<p><font style="font-size: larger;"> <span class="math inline">‚áí</span> The function <code>PCA()</code> in <a href="http://factominer.free.fr"><strong>FactoMineR</strong></a>, standardizes the data automatically. </font></p>
</div>
</div>
<div id="pca-syntax" class="slide section level2">
<h1><code>PCA()</code> Syntax</h1>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">PCA</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="co"># a data frame with n rows (individuals) and p columns (numeric variables)</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="at">X =</span> , </span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  </span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="co"># number of dimensions kept in the results (by default 5)</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="at">ncp =</span> , </span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="co"># a vector indicating the indexes of the supplementary individuals</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="at">ind.sup =</span> , </span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  </span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="co"># a vector indicating the indexes of the quantitative supplementary variables</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="at">quanti.sup =</span> ,</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  </span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  <span class="co"># a vector indicating the indexes of the categorical supplementary variables</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>  <span class="at">quali.sup =</span> , </span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  </span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  <span class="co"># boolean, if TRUE (default) a graph is displayed</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  <span class="at">graph =</span> </span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="running-pca" class="slide section level2">
<h1>Running <code>PCA()</code></h1>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">PCA</span>(<span class="at">X =</span> decathlon[, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>**Results for the Principal Component Analysis (PCA)**
The analysis was performed on 41 individuals, described by 10 variables
*The results are available in the following objects:

   name               description                          
1  "$eig"             "eigenvalues"                        
2  "$var"             "results for the variables"          
3  "$var$coord"       "coord. for the variables"           
4  "$var$cor"         "correlations variables - dimensions"
5  "$var$cos2"        "cos2 for the variables"             
6  "$var$contrib"     "contributions of the variables"     
7  "$ind"             "results for the individuals"        
8  "$ind$coord"       "coord. for the individuals"         
9  "$ind$cos2"        "cos2 for the individuals"           
10 "$ind$contrib"     "contributions of the individuals"   
11 "$call"            "summary statistics"                 
12 "$call$centre"     "mean of the variables"              
13 "$call$ecart.type" "standard error of the variables"    
14 "$call$row.w"      "weights for the individuals"        
15 "$call$col.w"      "weights for the variables"          </code></pre>
</div>
</div>
</div>
<div id="visualization-and-interpretation" class="slide section level2 build">
<h1 class="build">Visualization and Interpretation</h1>
<h3 id="the-factoextra-package">The <strong>factoextra</strong> package</h3>
<ul>
<li>It helps with interpretation of PCA.</li>
<li>No matter what function you decide to use (<code>stats::prcomp()</code>, <code>FactoMiner::PCA()</code>, <code>ade4::dudi.pca()</code>, <code>ExPosition::epPCA()</code>), you can easily extract and visualize the results of PCA using R functions provided in the <strong>factoextra</strong> R package.</li>
</ul>
<h3 id="useful-extraction-and-visualization-functions">Useful extraction and visualization functions</h3>
<ul>
<li><code>get_eigenvalue()</code>: Extract the eigenvalues/variances of principal components.</li>
<li><code>fviz_screeplot()</code>: Visualize the eigenvalues / proportion of explained variance.</li>
<li><code>get_pca_ind()</code>, <code>get_pca_var()</code>: Extract the results for individuals and variables, respectively.</li>
<li><code>fviz_pca_ind()</code>, <code>fviz_pca_var()</code>: Visualize the results individuals and variables, respectively.</li>
<li><code>fviz_pca_biplot()</code>: Make a biplot of individuals and variables.</li>
</ul>
</div>

<div id="choice-of-the-reduced-dimension" class="title-slide slide section level1">
<h1>Choice of the reduced dimension</h1>

</div>
<div id="eigenvalues-variances" class="slide section level2">
<h1>Eigenvalues / Variances</h1>
<div style="color: green;">
<p><font style="font-size: larger;"> Eigenvalues measure the amount of variation retained by each principal component. </font></p>
</div>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>eig_val <span class="ot">&lt;-</span> <span class="fu">get_eigenvalue</span>(res_pca)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">html_table</span>(eig_val)</span></code></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-2875f0f33a85175b7232" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2875f0f33a85175b7232">{"x":{"filter":"none","vertical":false,"data":[["Dim.1","Dim.2","Dim.3","Dim.4","Dim.5","Dim.6","Dim.7","Dim.8","Dim.9","Dim.10"],[3.271905537965689,1.737131023124383,1.40491668214964,1.056850353259466,0.6847735348598889,0.5992686808058334,0.4512352638032413,0.3968765857409067,0.2148148531722353,0.1822274851187157],[32.71905537965689,17.37131023124383,14.0491668214964,10.56850353259466,6.847735348598889,5.992686808058334,4.512352638032413,3.968765857409066,2.148148531722353,1.822274851187157],[32.71905537965689,50.09036561090073,64.13953243239712,74.70803596499178,81.55577131359067,87.54845812164901,92.06081075968142,96.02957661709048,98.17772514881284,100]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>eigenvalue<\/th>\n      <th>variance.percent<\/th>\n      <th>cumulative.variance.percent<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"searching":false,"lengthMenu":[5,10,15,20],"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"eigenvalue","targets":1},{"name":"variance.percent","targets":2},{"name":"cumulative.variance.percent","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="choosing-the-appropriate-number-of-pcs" class="slide section level2 build">
<h1 class="build">Choosing the appropriate number of PCs</h1>
<p>Eigenvalues can be used to determine the number of principal components to retain after PCA.</p>
<div style="float: left; width: 45%;">
<p><strong>Guidelines.</strong></p>
<ul>
<li>An eigenvalue &gt; 1 indicates that PCs account for more variance than accounted by one of the original variables in standardized data. This is commonly used as a cutoff point for which PCs are retained. This holds true only when the data are standardized.</li>
<li>Balance between a small number to achieve dimensionality reduction well and proporition of total variance explained.</li>
<li>Look at the first few principal components to find interesting patterns in the data.</li>
</ul>
</div>
<div style="float:right; width: 55%;">
<p><strong>Graphical tool.</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/screeplot-plot-1.png" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">fviz_screeplot</span>(res_pca, <span class="at">addlabels =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
</div>
</div>

<div id="analysis-of-the-variables" class="title-slide slide section level1">
<h1>Analysis of the variables</h1>

</div>
<div id="variable-information-in-pca" class="slide section level2 build">
<h1 class="build">Variable Information in PCA</h1>
<h3 id="variable-information-extraction">Variable information extraction</h3>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>var_info <span class="ot">&lt;-</span> <span class="fu">get_pca_var</span>(res_pca)</span></code></pre></div>
</div>
<h3 id="components">Components</h3>
<ul>
<li><code>var_info$coord</code>: Coordinates for the variables.</li>
<li><code>var_info$cos2</code>: Quality of representation of variables by PC: <code>var.cos2 = var.coord * var.coord</code>.</li>
<li><code>var_info$contrib</code>: Contributions of the variables to the principal components: <code>(var.cos2 * 100) / (sum cos2 of the component)</code>.</li>
</ul>
<h3 id="usage">Usage</h3>
<ul>
<li>Investigate the ability of PCs to strongly represent variables.</li>
<li>Describe each PC in terms of the most contributing variables.</li>
</ul>
</div>
<div id="coord-correlation-variables-components" class="slide section level2">
<h1><code>$coord</code>: Correlation variables &amp; components</h1>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-2d7aa373fb61780f86d6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2d7aa373fb61780f86d6">{"x":{"filter":"none","vertical":false,"data":[["100m","Long.jump","Shot.put","High.jump","400m","110m.hurdle","Discus","Pole.vault","Javeline","1500m"],[-0.7747198283340213,0.7418997449587648,0.6225025510528264,0.5719452960081449,-0.6796099426945478,-0.7462453239650743,0.5524665193042049,0.05034151309960859,0.2771108460213195,-0.05807705798207827],[0.1871419927385868,-0.3454212937592893,0.5983033206522113,0.350293607805047,0.5694377765902853,0.2287933453928043,0.6063133910814571,-0.1803568699005542,0.3169890605477803,0.4742237686865042],[-0.1844071392782159,0.1822110521528026,-0.02337843733549815,-0.2595119284438004,0.1314696986050091,-0.09263737981143892,0.04295225305372982,0.6917566549199458,-0.3896554074121316,0.7821428010828996],[-0.03781825744057764,0.1017856399676557,0.1905916066628507,-0.13559420328719,0.0293019760523687,0.2908310253178748,-0.259671434531017,0.5515339706355916,0.7122772805688381,-0.1610890358949582],[0.3021963924742369,0.03667804523836479,0.1111508230570835,0.555439570694534,-0.08769156535402756,0.1643209509746404,-0.1048271212831951,0.3299593171416433,-0.3051289206123195,-0.1535618897733169]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Dim.1<\/th>\n      <th>Dim.2<\/th>\n      <th>Dim.3<\/th>\n      <th>Dim.4<\/th>\n      <th>Dim.5<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"searching":false,"lengthMenu":[10,15,20,25],"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Dim.1","targets":1},{"name":"Dim.2","targets":2},{"name":"Dim.3","targets":3},{"name":"Dim.4","targets":4},{"name":"Dim.5","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div style="color: green; text-align: center;">
<p>Property: norms of column vectors is 1 (eigenvectors).<br>
Consequence: each coordinate is in [-1,1].</p>
</div>
</div>

<div id="contribution-of-pcs-to-variables" class="title-slide slide section level1">
<h1>Contribution of PCs to variables</h1>

</div>
<div id="fviz_pca_var-correlation-circle" class="slide section level2">
<h1><code>fviz_pca_var()</code>: Correlation circle</h1>
<div class="cell" layout-align="center">
<div class="sourceCode" id="cb7"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res_pca, <span class="at">col.var =</span> <span class="st">"black"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/pca-corrcirc-1.png" class="quarto-figure quarto-figure-center" width="912"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cos2-quality-of-representation" class="slide section level2">
<h1><code>$cos2</code>: Quality of representation</h1>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-a61d38e66da5a288a238" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a61d38e66da5a288a238">{"x":{"filter":"none","vertical":false,"data":[["100m","Long.jump","Shot.put","High.jump","400m","110m.hurdle","Discus","Pole.vault","Javeline","1500m"],[0.6001908124138952,0.55041523156988,0.3875094260672766,0.3271214216258444,0.4618696742092864,0.5568820835397384,0.3052192549521032,0.002534267941158064,0.07679042098265146,0.003372944663853679],[0.03502212544616928,0.1193158701823412,0.3579668635034626,0.1227056116690761,0.3242593814080875,0.05234639489603103,0.3676159282046958,0.03252860052032547,0.1004820645069643,0.2248881827872309],[0.0340059930167753,0.03320086752663135,0.0005465513322498138,0.06734644100462017,0.01728428165129191,0.008581684138328789,0.001844896042391642,0.4785272696260332,0.1518313365255143,0.6117473612858039],[0.001430220595841806,0.01036031650362522,0.03632516053032676,0.0183857879650878,0.0008586058005735883,0.08458268528744631,0.06742925391139624,0.3041897207650619,0.5073389244145393,0.02594967748556714],[0.09132265962444296,0.001345279002507533,0.01235450546626708,0.3085131166933281,0.007689810634239683,0.02700137492921016,0.01098872535652169,0.1088731509685796,0.09310365819403918,0.02358125399075231]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Dim.1<\/th>\n      <th>Dim.2<\/th>\n      <th>Dim.3<\/th>\n      <th>Dim.4<\/th>\n      <th>Dim.5<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"searching":false,"lengthMenu":[10,15,20,25],"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Dim.1","targets":1},{"name":"Dim.2","targets":2},{"name":"Dim.3","targets":3},{"name":"Dim.4","targets":4},{"name":"Dim.5","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div style="color: green; text-align: center;">
<p><strong>Positive</strong> and <strong>negative</strong> strong correlations of PCs to a given variable imply that the PCs represent it well.<br>
<strong>Squared</strong> correlations thus measure quality of representation.</p>
</div>
</div>
<div id="cos2-graphical-tool-1" class="slide section level2">
<h1><code>$cos2</code>: Graphical tool 1</h1>
<div class="cell" layout-align="center">
<div class="sourceCode" id="cb8"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(var_info<span class="sc">$</span>cos2, <span class="at">is.corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/pca-var-cos2-plot1-1.png" class="quarto-figure quarto-figure-center" width="912"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cos2-graphical-tool-2" class="slide section level2">
<h1><code>$cos2</code>: Graphical tool 2</h1>
<div class="cell" layout-align="center">
<div class="sourceCode" id="cb9"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Total cos2 of variables on Dim.1 and Dim.2</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_cos2</span>(res_pca, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/pca-var-cos2-plot2-1.png" class="quarto-figure quarto-figure-center" width="912"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cos2-summary" class="slide section level2 build">
<h1 class="build"><code>$cos2</code>: Summary</h1>
<div style="float: left; width: 40%;">
<ul>
<li>The <code>cos2</code> values are used to estimate the quality of the representation.</li>
<li>High <code>cos2</code> indicates a good representation of the variable by the corresponding PC.</li>
<li>Low <code>cos2</code> indicates that the variable is poorly represented by the corresponding PC.</li>
<li>Variables close to circle in plot are <strong>very well</strong> represented by the 1st two PCs.</li>
<li>Variables close to center in plot are <strong>not well</strong> represented by the 1st two PCs.</li>
</ul>
</div>
<div style="float: right; width: 60%;">
<div class="cell" layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/pca-var-plot-res-1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div style="float: left; width: 100%;">
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_var</span>(<span class="at">X =</span> res_pca, </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                         <span class="at">col.var =</span> <span class="st">"cos2"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                         <span class="at">gradient.cols =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">3</span>),</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                         <span class="at">repel =</span> <span class="cn">TRUE</span>) <span class="co"># Avoid text overlapping</span></span></code></pre></div>
</div>
</div>
</div>

<div id="contribution-of-variables-to-pcs" class="title-slide slide section level1">
<h1>Contribution of variables to PCs</h1>

</div>
<div id="contrib-important-variables" class="slide section level2">
<h1><code>$contrib</code>: Important variables</h1>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-8131de1e08e86f77aa80" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8131de1e08e86f77aa80">{"x":{"filter":"none","vertical":false,"data":[["100m","Long.jump","Shot.put","High.jump","400m","110m.hurdle","Discus","Pole.vault","Javeline","1500m"],[18.34376956943154,16.82246706645759,11.84353953898715,9.99788709759734,14.11622887182906,17.02011494763326,9.328486150057797,0.07745541280918969,2.346963263199707,0.1030880819973432],[2.016090034658347,6.868559054787997,20.60678548355137,7.063693528907178,18.66637444680935,3.013382076493082,21.16224529474503,1.872547325867216,5.784368776411492,12.94595397776903],[2.420498912771348,2.363191209021112,0.03890275766485631,4.793625263355442,1.23027093854744,0.6108322470196667,0.1313171140916911,34.06090024455018,10.80714169421063,43.54331961876769],[0.135328581897221,0.9803011818724046,3.43711485909951,1.739677515211459,0.08124194668862389,8.00327927474142,6.380208295662252,28.78266727421723,48.00480246326635,2.4553786073435],[13.33618415073948,0.1964560448123613,1.804173911130332,45.05330609140041,1.122971353706462,3.943110175064652,1.604724014161863,15.89914700644149,13.59626992785127,3.443657324691624]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Dim.1<\/th>\n      <th>Dim.2<\/th>\n      <th>Dim.3<\/th>\n      <th>Dim.4<\/th>\n      <th>Dim.5<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"searching":false,"lengthMenu":[9,14,19,24],"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Dim.1","targets":1},{"name":"Dim.2","targets":2},{"name":"Dim.3","targets":3},{"name":"Dim.4","targets":4},{"name":"Dim.5","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div style="color: green;">
<ul>
<li>Variables correlating with <code>Dim.1</code> (PC1) and <code>Dim.2</code> (PC2) are the most important to explain the variability in the data set.</li>
<li>Variables that do not correlate with any PC or only with the last ones are variables might be removed to simplify the overall analysis.</li>
</ul>
</div>
</div>
<div id="contrib-graphical-tool-1" class="slide section level2">
<h1><code>$contrib</code>: Graphical tool 1</h1>
<div class="cell" layout-align="center">
<div class="sourceCode" id="cb11"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(var_info<span class="sc">$</span>contrib, <span class="at">is.corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/pca-var-contrib-plot1-1.png" class="quarto-figure quarto-figure-center" width="912"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="contrib-graphical-tool-2" class="slide section level2">
<h1><code>$contrib</code>: Graphical tool 2</h1>
<div style="float: left; width: 50%;">
<div class="cell" layout-align="center">
<div class="sourceCode" id="cb12"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Contributions of variables to PC1</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_contrib</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="at">X =</span> res_pca, </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="at">choice =</span> <span class="st">"var"</span>, </span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="at">axes =</span> <span class="dv">1</span>, </span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="at">top =</span> <span class="dv">10</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/pca-var-contrib-plot2-pc1-1.png" class="quarto-figure quarto-figure-center" style="width:99.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div style="float: right; width: 50%;">
<div class="cell" layout-align="center">
<div class="sourceCode" id="cb13"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Contributions of variables to PC2</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_contrib</span>(</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="at">X =</span> res_pca, </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="at">choice =</span> <span class="st">"var"</span>, </span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="at">axes =</span> <span class="dv">2</span>, </span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="at">top =</span> <span class="dv">10</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/pca-var-contrib-plot2-pc2-1.png" class="quarto-figure quarto-figure-center" style="width:99.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div id="contrib-summary" class="slide section level2">
<h1><code>$contrib</code>: Summary</h1>
<div class="cell" layout-align="center">
<div class="sourceCode" id="cb14"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_var</span>(</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="at">X =</span> res_pca, </span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="at">col.var =</span> <span class="st">"contrib"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="at">gradient.cols =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">3</span>),</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/pca-var-contrib-plot-1.png" class="quarto-figure quarto-figure-center" width="912"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="component-description" class="slide section level2">
<h1>Component description</h1>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>res_pca_var_desc <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">dimdesc</span>(<span class="at">res =</span> res_pca, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">proba =</span> <span class="fl">0.05</span>)</span></code></pre></div>
</div>
<div style="float: left; width: 50%; text-align: center;">
<p><strong>Description of PC1</strong></p>
<div class="cell" layout-align="center">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-715891c5e4e3b29b09dd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-715891c5e4e3b29b09dd">{"x":{"filter":"none","vertical":false,"data":[["Long.jump","Shot.put","High.jump","Discus","400m","110m.hurdle","100m"],[0.7418997449587647,0.6225025510528263,0.571945296008145,0.5524665193042049,-0.6796099426945477,-0.7462453239650745,-0.7747198283340211],[2.849885834300399e-08,1.388320669687368e-05,9.362284800674762e-05,0.0001802219952329804,1.02817455844083e-06,2.136961517393902e-08,2.778466579708301e-09]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>correlation<\/th>\n      <th>p.value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"searching":false,"lengthMenu":[10,15,20,25],"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"correlation","targets":1},{"name":"p.value","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div style="float: right; width: 50%; text-align: center;">
<p><strong>Description of PC2</strong></p>
<div class="cell" layout-align="center">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d50608b4f83910727725" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d50608b4f83910727725">{"x":{"filter":"none","vertical":false,"data":[["Discus","Shot.put","400m","1500m","High.jump","Javeline","Long.jump"],[0.606313391081457,0.5983033206522108,0.5694377765902847,0.4742237686865041,0.3502936078050471,0.3169890605477801,-0.345421293759289],[2.650744527959237e-05,3.603567347530272e-05,0.0001020941248520886,0.001734405284058427,0.02475025039761204,0.04344974126074663,0.02696968983645745]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>correlation<\/th>\n      <th>p.value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"searching":false,"lengthMenu":[10,15,20,25],"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"correlation","targets":1},{"name":"p.value","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>

<div id="analysis-of-the-individuals" class="title-slide slide section level1">
<h1>Analysis of the individuals</h1>

</div>
<div id="the-reduced-space" class="slide section level2">
<h1>The reduced space</h1>
<h3 id="individual-information-extraction">Individual information extraction</h3>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>ind_info <span class="ot">&lt;-</span> <span class="fu">get_pca_ind</span>(res_pca)</span></code></pre></div>
</div>
<h3 id="components-1">Components</h3>
<ul>
<li><code>ind_info$coord</code>: Coordinates of the individuals.</li>
<li><code>ind_info$cos2</code>: Quality of representation of individuals by PC: <code>ind.cos2 = ind.coord * ind.coord</code>.</li>
<li><code>ind_info$contrib</code>: Contributions of the individuals to the principal components: <code>(ind.cos2 * 100) / (sum cos2 of the component)</code>.</li>
</ul>
<h3 id="usage-1">Usage</h3>
<ul>
<li>The reduced space should allow easier identification of patterns, provided that it represents them well.</li>
<li>Individuals that are similar are grouped together on the plot.</li>
</ul>
</div>
<div id="first-factorial-plane-quality" class="slide section level2">
<h1>First factorial plane &amp; quality</h1>
<div class="cell" layout-align="center">
<div class="sourceCode" id="cb17"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="at">X =</span> res_pca, </span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="at">col.ind =</span> <span class="st">"cos2"</span>, </span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="at">gradient.cols =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">3</span>),</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span> <span class="co"># Avoid text overlapping (slow if many points)</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/res-pca-ind-cos2-1.png" class="quarto-figure quarto-figure-center" width="912"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="first-factorial-plane-contribution" class="slide section level2">
<h1>First factorial plane &amp; contribution</h1>
<div class="cell" layout-align="center">
<div class="sourceCode" id="cb18"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Total contribution on PC1 and PC2</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_contrib</span>(res_pca, <span class="at">choice =</span> <span class="st">"ind"</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/res-pca-ind-contrib-1.png" class="quarto-figure quarto-figure-center" width="912"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="first-factorial-plane-colored-by-groups" class="slide section level2">
<h1>First factorial plane colored by groups</h1>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="at">X =</span> res_pca,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="at">col.ind =</span> decathlon<span class="sc">$</span>competition[<span class="dv">1</span><span class="sc">:</span><span class="dv">23</span>], <span class="co"># color by groups</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="at">palette =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">3</span>),</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, <span class="co"># Concentration ellipses</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="st">"Competition"</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div style="float: left; width: 42%;">
<ul>
<li>This plot is useful to understand the ability of a factorial plane to discriminate individuals based on some feature.</li>
<li>Here, we see a tendency with positive score on PC1 for athletes at the Olympics and negative PC1 scores for athletes at the Decastar.</li>
<li>But, ellipses seem to overlap significantly.</li>
</ul>
</div>
<div style="float: right; width: 58%;">
<div class="cell" layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/res-pca-competition-plot-1.png" class="quarto-figure quarto-figure-center" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>

<div id="combined-variable-and-individual-analysis" class="title-slide slide section level1">
<h1>Combined variable and individual analysis</h1>

</div>
<div id="biplot" class="slide section level2">
<h1>Biplot</h1>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_biplot</span>(</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="at">X =</span> res.pca, </span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  <span class="at">col.var =</span> <span class="st">"#2E9FDF"</span>, <span class="co"># Variables color</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="at">col.ind =</span> <span class="st">"#696969"</span>  <span class="co"># Individuals color</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div style="float: left; width: 42%;">
<ul>
<li>Only useful when there is a low number of variables and individuals in the data set; otherwise unreadable.</li>
<li>Coordinate of individuals and variables are not constructed on the same space: focus on the direction of variables but not on their absolute positions.</li>
<li>An individual that is on the same side of a given variable has a high value for this variable.</li>
<li>An individual that is on the opposite side of a given variable has a low value for this variable.</li>
</ul>
</div>
<div style="float: right; width: 58%;">
<div class="cell" layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="12-PCA-Slides_files/figure-slidy/res-pca-biplot-plot-1.png" class="quarto-figure quarto-figure-center" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div id="interpretation" class="slide section level2">
<h1>Interpretation</h1>
<ul>
<li>The first two dimensions resume 50% of the total inertia (i.e.&nbsp;the total variance of data set).</li>
<li>The variable <code>100m</code> is correlated negatively to the variable <code>long.jump</code>. When an athlete performs a short time when running 100m, he can jump a big distance. Here one has to be careful because a low value for the variables <code>100m</code>, <code>400m</code>, <code>110m.hurdle</code> and <code>1500m</code> means a high score: the shorter an athlete runs, the more points he scores.</li>
<li>The first axis opposes athletes who are <strong>good everywhere</strong> like Karpov during the Olympic Games to those who are <strong>bad everywhere</strong> like Bourguignon during the Decastar. This dimension is particularly linked to the variables of speed and long jump which constitute a homogeneous group.</li>
<li>The second axis opposes athletes who are <strong>strong</strong> (variables <code>Discus</code> and <code>Shot.put</code>) to those who are <strong>weak</strong>.</li>
<li>The variables <code>Discus</code>, <code>Shot.put</code> and <code>High.jump</code> are not much correlated to the variables <code>100m</code>, <code>400m</code>, <code>110m.hurdle</code> and <code>Long.jump</code>. This means that strength is not much correlated to speed.</li>
</ul>
<div style="color: green; text-align: center;">
<p><font style="font-size: larger;"> At this point, we can divide the first factorial plane into four parts: fast and strong athletes (like Sebrle), slow athletes (like Casarsa), fast but weak athletes (like Warners) and slow and weak athletes (like Lorenzo). </font></p>
</div>
</div>
<div id="your-turn" class="slide section level2">
<h1>Your turn</h1>
<ul>
<li>Download the lab file and related data sets from the course website in a folder on your computer.</li>
<li>Open the file <code>12-PCA-Exercises.qmd</code> and perform the PCA analyses for the proposed data sets.</li>
</ul>
</div>
<div id="references" class="slide section level2">
<h1>References</h1>
<ul>
<li><a href="https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c" class="uri">https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c</a></li>
<li><a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/" class="uri">http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/</a></li>
<li><a href="https://builtin.com/data-science/step-step-explanation-principal-component-analysis" class="uri">https://builtin.com/data-science/step-step-explanation-principal-component-analysis</a></li>
<li><a href="https://royalsocietypublishing.org/doi/pdf/10.1098/rsta.2015.0202" class="uri">https://royalsocietypublishing.org/doi/pdf/10.1098/rsta.2015.0202</a></li>
<li><a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/" class="uri">http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/</a></li>
<li><a href="http://factominer.free.fr/factomethods/principal-components-analysis.html" class="uri">http://factominer.free.fr/factomethods/principal-components-analysis.html</a></li>
</ul>

</div>

<script>
  // htmlwidgets need to know to resize themselves when slides are shown/hidden.
  // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
  // slide changes (different for each slide format).
  (function () {
    // dispatch for htmlwidgets
    function fireSlideEnter() {
      const event = window.document.createEvent("Event");
      event.initEvent("slideenter", true, true);
      window.document.dispatchEvent(event);
    }

    function fireSlideChanged(previousSlide, currentSlide) {
      fireSlideEnter();

      // dispatch for shiny
      if (window.jQuery) {
        if (previousSlide) {
          window.jQuery(previousSlide).trigger("hidden");
        }
        if (currentSlide) {
          window.jQuery(currentSlide).trigger("shown");
        }
      }
    }

    // hookup for slidy
    if (window.w3c_slidy) {
      window.w3c_slidy.add_observer(function (slide_num) {
        // slide_num starts at position 1
        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
      });
    }

  })();
</script>



</body></html>